{% extends 'base.html' %}

{% block body %}

<div class="container justify-content-center d-flex mt-2">
    <div class="card p-4">
        <form method="POST" id="formBusca">
            {{ form.csrf_token }}
            <div class="d-flex">
                <legend>Buscar ASO</legend>
                <img src="{{ url_for('static', filename='images/logo_socnet.png') }}" alt="Icone SOCNET" height="25px" width="100px">
            </div>
            <div class="form-group form-check form-switch">
                {{ form.pesquisa_geral(class="form-check-input", id="flexSwitch") }}
                {{ form.pesquisa_geral.label(class="form-check-label", for="flexSwitch") }}
            </div>
            <fieldset>
            <!-- EMPRESA PRINCIPAL-->
            <div class="form-group">
                {{ form.cod_empresa_principal.label(class="form-control-label") }}
                {% if form.cod_empresa_principal.errors %}
                {{ form.cod_empresa_principal(class="form-control is-invalid") }}
                <div class="invalid-feedback">
                    {% for erro in form.cod_empresa_principal.errors %}
                    {{ erro }}
                    {% endfor %}
                </div>
                {% else %}
                {{ form.cod_empresa_principal(class="form-control") }}
                {% endif %}
            </div>
            
            <div class="d-flex justify-content-between">
                <!-- INICIO -->
                <div class="form-group w-49">
                    {{ form.data_inicio.label(class="form-control-label") }}
                    {% if form.data_inicio.errors %}
                    {{ form.data_inicio(class="form-control is-invalid") }}
                    <div class="invalid-feedback">
                        {% for erro in form.data_inicio.errors %}
                        {{ erro }}
                        {% endfor %}
                    </div>
                    {% else %}
                    {{ form.data_inicio(class="form-control") }}
                    {% endif %}
                </div>
                <!-- FIM -->
                <div class="form-group w-49">
                    {{ form.data_fim.label(class="form-control-label") }}
                    {% if form.data_fim.errors %}
                    {{ form.data_fim(class="form-control is-invalid") }}
                    <div class="invalid-feedback">
                        {% for erro in form.data_fim.errors %}
                        {{ erro }}
                        {% endfor %}
                    </div>
                    {% else %}
                    {{ form.data_fim(class="form-control") }}
                    {% endif %}
                </div>
            </div>
            <div class="d-flex justify-content-between">
                <!-- STATUS -->
                <div class="form-group w-49">
                    {{ form.status.label(class="form-control-label") }}
                    {% if form.status.errors %}
                    {{ form.status(class="form-control is-invalid") }}
                        <div class="invalid-feedback">
                        {% for erro in form.status.errors %}
                            {{ erro }}
                        {% endfor %}
                        </div>
                    {% else %}
                    {{ form.status(class="form-control") }}
                    {% endif %}
                </div>
            <!-- TAG -->
            <div class="form-group w-49">
                {{ form.tag.label(class="form-control-label") }}
                {% if form.tag.errors %}
                    {{ form.tag(class="form-control is-invalid", disabled=True) }}
                    <div class="invalid-feedback">
                        {% for erro in form.tag.errors %}
                            {{ erro }}
                        {% endfor %}
                    </div>
                {% else %}
                    {{ form.tag(class="form-control", disabled=True) }}
                {% endif %}
            </div>
            </div>
            <div class="accordion mt-3" id="accordion01">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingOne">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                            <b>Mais opções</b>
                        </button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#accordion01">
                        <div class="accordion-body">
                            <!-- EMPRESA -->
                            <div class="form-group">
                                {{ form.empresa.label(class="form-control-label") }}
                                {% if form.empresa.errors %}
                                {{ form.empresa(class="form-control is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for erro in form.empresa.errors %}
                                    {{ erro }}
                                    {% endfor %}
                                </div>
                                {% else %}
                                {{ form.empresa(class="form-control") }}
                                {% endif %}
                            </div>
                            <!-- UNIDADE -->
                            <div class="form-group">
                                {{ form.unidade.label(class="form-control-label") }}
                                {% if form.unidade.errors %}
                                {{ form.unidade(class="form-control is-invalid", disabled=True) }}
                                <div class="invalid-feedback">
                                    {% for erro in form.unidade.errors %}
                                    {{ erro }}
                                    {% endfor %}
                                </div>
                                {% else %}
                                {{ form.unidade(class="form-control", disabled=True) }}
                                {% endif %}
                            </div>
                            <!-- PRESTADOR -->
                            <div class="form-group">
                                {{ form.prestador.label(class="form-control-label") }}
                                {% if form.prestador.errors %}
                                {{ form.prestador(class="form-control is-invalid") }}
                                <div class="invalid-feedback">
                                    {% for erro in form.prestador.errors %}
                                    {{ erro }}
                                    {% endfor %}
                                </div>
                                {% else %}
                                {{ form.prestador(class="form-control") }}
                                {% endif %}
                            </div>
                            <div class="d-flex justify-content-between">
                                <!-- SEQ FICHA -->
                                <div class="form-group w-49">
                                    {{ form.seq_ficha.label(class="form-control-label") }}
                                    {% if form.seq_ficha.errors %}
                                    {{ form.seq_ficha(class="form-control is-invalid") }}
                                        <div class="invalid-feedback">
                                        {% for erro in form.seq_ficha.errors %}
                                            {{ erro }}
                                        {% endfor %}
                                        </div>
                                    {% else %}
                                    {{ form.seq_ficha(class="form-control") }}
                                    {% endif %}
                                </div>
                                <!-- FUNCIONARIO -->
                                <div class="form-group w-49">
                                    {{ form.funcionario.label(class="form-control-label") }}
                                    {% if form.funcionario.errors %}
                                    {{ form.funcionario(class="form-control is-invalid") }}
                                        <div class="invalid-feedback">
                                        {% for erro in form.funcionario.errors %}
                                            {{ erro }}
                                        {% endfor %}
                                        </div>
                                    {% else %}
                                    {{ form.funcionario(class="form-control") }}
                                    {% endif %}
                                </div>
                            </div>
                            <!-- OBS -->
                            <div class="form-group">
                                {{ form.obs.label(class="form-control-label") }}
                                {% if form.obs.errors %}
                                {{ form.obs(class="form-control is-invalid") }}
                                    <div class="invalid-feedback">
                                    {% for erro in form.obs.errors %}
                                        {{ erro }}
                                    {% endfor %}
                                    </div>
                                {% else %}
                                {{ form.obs(class="form-control") }}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </fieldset>
            <!-- BOTOES -->
            <div class="d-flex mt-3 justify-content-between">
                <button type="submit" class="btn btn-primary text-nowrap" style="width: fit-content;" name="btn_buscar">
                    <span class="material-icons align-middle">manage_search</span> Buscar
                </button>
                <button type="submit" class="btn btn-success text-nowrap" style="width: fit-content;" name="btn_csv">
                    <span class="material-icons align-middle">download</span> Gerar relatório
                </button>
                <button type="submit" class="btn btn-info text-nowrap text-light" style="width: fit-content;" name="btn_emails">
                    <span class="material-icons align-middle">mail</span> Enviar Emails
                </button>
                <button type="button" class="btn btn-secondary text-nowrap" style="width: fit-content;" onclick="limpar()">
                    <span class="material-icons align-middle">close</span> Limpar
                </button>
            </div>
        </form>
        <script>
            function limpar() {
              document.getElementById("formBusca").reset();
              CarregarOpcoesBuscaSOCNET('cod_empresa_principal', 'empresa', 'prestador', 'unidade', 'flexSwitch');
            }
        </script>
    </div>
</div>

{% endblock %}